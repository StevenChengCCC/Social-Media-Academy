# 1. 枚举类型
enum SlangCategory {
  STANDARD    # 对应你原来的 NORMAL_TERMS
  CHINESE     # 对应你原来的 CN_SLANG
  SENSITIVE   # 对应你原来的 SENSITIVE_TERMS
}

enum RequestType {
  ADD         # 申请添加新词
  EDIT        # 申请修改现有词
  QUESTION    # 提问/求解释
}

enum RequestStatus {
  PENDING     # 待审核
  APPROVED    # 已通过
  REJECTED    # 已拒绝
}

# 2. 正式发布的俚语词条
type SlangTerm @model @auth(rules: [
  # 所有人(包括未登录)都可以读
  { allow: public, operations: [read] },
  # 只有 Admin 组可以增删改
  { allow: groups, groups: ["Admins"], operations: [create, update, delete] }
]) {
  id: ID!
  term: String!
  meaning: String!
  category: SlangCategory!
  example: String
}

# 3. 用户的贡献 (用于排行榜)
type Contribution @model @auth(rules: [
  { allow: owner, operations: [create, read] },
  { allow: public, operations: [read] }, # 允许公开读取以便生成排行榜
  { allow: groups, groups: ["Admins"], operations: [create, read, update, delete] }
]) {
  id: ID!
  type: RequestType!
  term: String!
  proposedMeaning: String
  note: String
  status: RequestStatus!
  adminResponse: String
  owner: String # Amplify 会自动填充，但在查询时我们需要聚合它
}

# 4. 新增：用户行为分析 (Analytics)
type UserAnalytics @model @auth(rules: [
  # 允许任何人（包括未登录用户）创建记录
  { allow: public, operations: [create] },
  # 只有管理员可以读取数据
  { allow: groups, groups: ["Admins"], operations: [read, delete] }
]) {
  id: ID!
  userId: String!       # 存储 Cognito User ID 或 匿名 UUID
  isAnonymous: Boolean! # 标记是否为匿名用户
  page: String!         # 页面路径或名称 (e.g., "/tiktok")
  durationSeconds: Int! # 停留时长 (秒)
  clickCount: Int!      # 点击次数
  timestamp: AWSDateTime
}